# Nama alur kerja (workflow) Anda
name: Run Preprocessing Pipeline

# Pemicu (trigger) kapan workflow ini akan berjalan
on:
  # Jalankan setiap kali ada 'push' ke branch 'main'
  push:
    branches: [ main ]
  # Juga bisa dijalankan manual dari tab Actions di GitHub
  workflow_dispatch:

# Daftar pekerjaan (jobs) yang akan dilakukan
jobs:
  build:
    # Menentukan jenis server/runner yang akan digunakan
    runs-on: ubuntu-latest

    # Langkah-langkah (steps) yang akan dieksekusi secara berurutan
    steps:
          # 1. Checkout Repository
          - name: Checkout Repository
            uses: actions/checkout@v4

          # 2. Set up Python
          - name: Set up Python
            uses: actions/setup-python@v4
            with:
              python-version: '3.11'

          # 3. Install Dependencies
          - name: Install Dependencies
            run: |
              python -m pip install --upgrade pip
              pip install -r requirements.txt

           # 4. DOWNLOAD DATA NLTK (TAMBAHKAN BLOK INI)
          - name: Download NLTK Stopwords
            run: python -m nltk.downloader stopwords punkt

          # 5. Run Preprocessing Script
          - name: Run Preprocessing Script
            working-directory: ./preprocessing
            run: python automate_preprocessing.py

          # 6. Upload Processed Data Artifact
          - name: Upload Processed Data Artifact
            uses: actions/upload-artifact@v4
            with:
              name: processed-data
              path: preprocessing/data_processed/dataset_rs_processed.csv